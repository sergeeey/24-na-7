# ADR 0004: Архитектура Modulith (Модульный монолит)

**Статус:** Принято  
**Дата:** 2024-02-17  
**Авторы:** Команда разработки

## Context

Требовалась архитектура, которая позволяет начать с монолита, но обеспечивает возможность разделения на микросервисы в будущем при необходимости.

## Decision

Выбрана архитектура Modulith (модульный монолит).

**Структура:**
- Модули по доменам: `api/`, `asr/`, `digest/`, `storage/`, `osint/`, `memory/`
- Чёткое разделение ответственности между модулями
- Единый интерфейс для взаимодействия (DatabaseBackend, LLMClient)
- Возможность выделения модулей в отдельные сервисы

**Рефакторинг API:**
- Разделение `main.py` на роутеры по функциональности
- Middleware вынесены в отдельные модули
- Чёткое разделение endpoints по доменам

## Consequences

**Положительные:**
- Простота разработки и деплоя (один процесс)
- Возможность разделения на микросервисы при необходимости
- Чёткая модульность упрощает тестирование
- Меньше overhead по сравнению с микросервисами

**Отрицательные:**
- Все модули в одном процессе (единая точка отказа)
- Сложнее масштабировать отдельные компоненты независимо
- Необходимость дисциплины для поддержания модульности

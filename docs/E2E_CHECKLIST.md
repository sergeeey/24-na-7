# E2E проверка: Backend + Android (WebSocket)

Быстрый чеклист для проверки полного цикла: запись → VAD → WebSocket → транскрипция → UI.

## 1. Backend (2 мин)

```bash
cd "D:\24 na 7"
set PYTHONPATH=src
uvicorn src.api.main:app --reload
```

Проверка:
```bash
curl http://localhost:8000/health
# Ожидается: {"status":"healthy",...}
```

## 2. Эмулятор + приложение (5 мин)

- Android Studio → Run → устройство: эмулятор (например Pixel 4 API 33).
- Run 'app' → приложение открылось.
- Запись **стартует автоматически** при запуске (foreground-сервис). На экране: «Reflexio Recording», «Recording audio in background…», ниже блок «Diary» со списком записей (сразу пустой или с уже сохранёнными).

## 3. Запись и VAD (5 мин)

- Сказать в микрофон: *"Hello, this is a test message for Reflexio"*.
- Пауза ~1 с (VAD завершает сегмент).
- Сказать: *"This is the second segment"*.
- Пауза ~1 с.

В Logcat ожидаются: `VAD segment saved`, `Inserting recording`, затем отправка по WebSocket.

## 4. WebSocket и UI (5 мин)

- В логах: подключение к `ws://10.0.2.2:8000`, отправка сегментов, получение `transcription`.
- В приложении список «Diary» на главном экране — после обработки появятся записи со статусом **Done** и текстом транскрипции (при необходимости прокрутить список).

## 5. Ошибка (3 мин)

- Остановить backend (Ctrl+C).
- Записать ещё одну фразу.
- Ожидается: новая запись со статусом **Failed**.
- Запустить backend снова — приложение должно продолжать работать.

## Чеклист

- [ ] Backend запущен, `/health` 200
- [ ] Приложение на эмуляторе, запись идёт
- [ ] Две фразы → два сегмента в логах
- [ ] В дневнике две записи, статус Done, транскрипции видны
- [ ] При выключенном backend запись получает статус Failed

## Реальное устройство

В `android/app/build.gradle.kts` в блоке **debug** заменить IP в `SERVER_WS_URL_DEVICE` на IP вашего ПК в LAN (например `ws://192.168.1.100:8000`). Собрать и установить приложение на телефон.

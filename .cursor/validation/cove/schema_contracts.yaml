# CoVe (Consistency & Verification) Schema Contracts
# JSONSchema контракты для outputs системы

version: "1.0"
updated: "2025-11-03"

schemas:
  claim:
    type: object
    required: ["text", "source_urls", "confidence", "extracted_at"]
    properties:
      text:
        type: string
        minLength: 1
        maxLength: 5000
      source_urls:
        type: array
        items:
          type: string
          format: uri
        minItems: 0
      confidence:
        type: number
        minimum: 0.0
        maximum: 1.0
      category:
        type: string
      extracted_at:
        type: string
        format: date-time

  validated_claim:
    type: object
    required: ["claim", "validation_status", "critic_confidence", "calibrated_confidence", "validated_at"]
    properties:
      claim:
        $ref: "#/schemas/claim"
      validation_status:
        type: string
        enum: ["supported", "refuted", "uncertain"]
      critic_confidence:
        type: number
        minimum: 0.0
        maximum: 1.0
      calibrated_confidence:
        type: number
        minimum: 0.0
        maximum: 1.0
      evidence:
        type: array
        items:
          type: string
      validated_at:
        type: string
        format: date-time

  digest:
    type: object
    required: ["date", "facts", "insights", "tasks", "generated_at"]
    properties:
      date:
        type: string
        format: date
      facts:
        type: array
        items:
          type: object
          required: ["text", "timestamp"]
          properties:
            text:
              type: string
            timestamp:
              type: string
              format: date-time
            confidence:
              type: number
      insights:
        type: array
        items:
          type: object
          required: ["text"]
          properties:
            text:
              type: string
            category:
              type: string
      tasks:
        type: array
        items:
          type: object
          required: ["text"]
          properties:
            text:
              type: string
            priority:
              type: string
              enum: ["high", "medium", "low"]
      generated_at:
        type: string
        format: date-time

  metrics:
    type: object
    required: ["timestamp", "service", "version"]
    properties:
      timestamp:
        type: string
        format: date-time
      service:
        type: string
      version:
        type: string
      osint:
        type: object
        properties:
          avg_deepconf_confidence:
            type: number
          missions_completed:
            type: integer
          total_claims:
            type: integer
          validated_claims:
            type: integer
      mcp:
        type: object
        properties:
          brave_latency_ms:
            type: number
          brightdata_latency_ms:
            type: number
      governance:
        type: object
        properties:
          current_level:
            type: integer
          reliability_index:
            type: number

  osint_mission_result:
    type: object
    required: ["mission_id", "status", "tasks_completed", "validated_claims"]
    properties:
      mission_id:
        type: string
      status:
        type: string
        enum: ["completed", "failed", "partial"]
      tasks_completed:
        type: integer
        minimum: 0
      total_tasks:
        type: integer
      validated_claims:
        type: array
        items:
          $ref: "#/schemas/validated_claim"
      errors:
        type: array
        items:
          type: string
      completed_at:
        type: string
        format: date-time











